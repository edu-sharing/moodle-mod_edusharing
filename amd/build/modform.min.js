define("mod_edusharing/modform",["exports","./repository"],(function(_exports,_repository){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;_exports.init=async(repoUrl,mediatype,hasRendering2)=>{var _document$getElementB;const gradeForm=document.getElementById("id_modstandardgrade"),gradeCompletionInput=null===(_document$getElementB=document.getElementById("id_completionusegrade"))||void 0===_document$getElementB?void 0:_document$getElementB.closest(".row.fitem");"file-h5p"===mediatype&&hasRendering2||(null!==gradeForm&&gradeForm.classList.add("d-none"),null!==gradeCompletionInput&&gradeCompletionInput.classList.add("d-none")),"function"!=typeof window.openRepo&&(window.openRepo=function(url){window.addEventListener("message",(function handleRepo(event){if("APPLY_NODE"===event.data.event){const node=event.data.data;if("file-h5p"===node.mediatype&&hasRendering2&&null!==gradeForm&&null!==gradeCompletionInput)gradeForm.classList.remove("d-none"),gradeCompletionInput.classList.remove("d-none");else{const gradeTypeSelect=document.getElementById("id_grade_modgrade_type");gradeTypeSelect.value="none",gradeTypeSelect.dispatchEvent(new Event("change",{bubbles:!0}))}window.win.close(),window.document.getElementById("id_object_url").value=node.objectUrl;let title=node.title;title||(title=node.properties["cm:name"]);let version=-1;void 0!==node.properties["cclom:version"]&&(version=node.properties["cclom:version"][0],window.document.getElementById("id_object_version_1").value=version);let aspects=node.aspects;aspects.includes("ccm:published")||aspects.includes("ccm:collection_io_reference")||-1===version?(window.document.getElementById("id_object_version_0").checked=!0,window.document.getElementById("id_object_version_1").closest("label").hidden=!0):window.document.getElementById("id_object_version_1").closest("label").hidden=!1,window.document.getElementById("fitem_id_object_title").getElementsByClassName("form-control-static")[0].innerHTML=title,""===window.document.getElementById("id_name").value&&(window.document.getElementById("id_name").value=title),window.removeEventListener("message",handleRepo,!1)}}),!1),window.win=window.open(url)});const repoSearch=new URL(repoUrl+"/components/search?applyDirectories=false&reurl=WINDOW"),repoWorkspace=new URL(repoUrl+"/components/workspace/files?applyDirectories=false&reurl=WINDOW"),repoCollections=new URL(repoUrl+"/components/collections?applyDirectories=false&reurl=WINDOW"),ajaxParams={eduTicketStructure:{courseId:0}};document.getElementById("id_edu_search_button").addEventListener("click",(async()=>{const ticket=await(0,_repository.getTicket)(ajaxParams),repoSearchWithTicket=new URL(repoSearch);repoSearchWithTicket.searchParams.set("ticket",ticket.ticket),window.openRepo(repoSearchWithTicket.toString())}));const repoWorkspaceButton=document.getElementById("id_edu_workspace_button");null!==repoWorkspaceButton&&repoWorkspaceButton.addEventListener("click",(async()=>{const ticket=await(0,_repository.getTicket)(ajaxParams),repoWorkspaceWithTicket=new URL(repoWorkspace);repoWorkspaceWithTicket.searchParams.set("ticket",ticket.ticket),window.openRepo(repoWorkspaceWithTicket.toString())}));const repoCollectionsButton=document.getElementById("id_edu_collections_button");null!==repoCollectionsButton&&repoCollectionsButton.addEventListener("click",(async()=>{const ticket=await(0,_repository.getTicket)(ajaxParams),repoCollectionsWithTicket=new URL(repoCollections);repoCollectionsWithTicket.searchParams.set("ticket",ticket.ticket),window.openRepo(repoCollectionsWithTicket.toString())}))}}));

//# sourceMappingURL=modform.min.js.map